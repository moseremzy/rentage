import{_ as we,u as xe,a as ke,r as i,f as W,g as Y,t as J,P as Ee,o as Le,h as Ie,H as X,i as K,b as d,c as h,e as a,n as y,j as b,k as s,D as De,l as E,w as Q,m as v,z as m,C as Z,E as ee,B as H,A as I,M as Ce,K as Be,F as Me,p as ze,d as Re,q as He}from"./index-LjW8QbZt.js";import{E as Pe}from"./ErrorModal-_8tJkFS0.js";import{C as Se}from"./ConfirmationModal-qGjs4P3k.js";const u=B=>(ze("data-v-37b05b55"),B=B(),Re(),B),Te=u(()=>a("div",{class:"cover",id:"insufficient_coin_cover",style:{display:"none"}},null,-1)),Ae={class:"remove modal",id:"insufficient_coin_nav",style:{display:"none"}},Oe={class:"remove modal"},Ne=u(()=>a("hr",{class:"remove modal"},null,-1)),$e=u(()=>a("h2",{class:"remove modal",style:{"font-weight":"bold"}},"Oops! seems you ran out of coins.",-1)),qe=u(()=>a("p",{class:"remove modal"},[a("a",{href:"/dashboard/buy-easycoin",style:{color:"rgba(10, 142, 146, 0.882)","text-decoration":"none"},class:"remove"},"Buy"),y(" more easycoin to list properties")],-1)),Fe={class:"header"},Ue=u(()=>a("div",{class:"logo"},[a("a",{href:"#"},[a("img",{src:He,id:"logo",alt:"Logo"})])],-1)),je={class:"accesslinks"},Ve={class:"container"},Ge={class:"pictures"},We={class:"grid"},Ye={key:1,style:{"margin-bottom":"5px","font-size":"14px",color:"rgba(10,142,146,.884)"}},Je=["src"],Xe=u(()=>a("h3",{style:{margin:"0px 0 10px 0"}},"Drag and drop to upload pictures",-1)),Ke=u(()=>a("div",null,"or click to select a file from your computer",-1)),Qe={style:{"margin-top":"23px"}},Ze={style:{"font-size":"11px",color:"red",margin:"0 0 4px 0"}},ea={key:0,style:{"font-size":"11px",color:"red",margin:"0 0 4px 0"}},aa={key:0,class:"loading-area"},ta={key:0,class:"row"},sa={class:"details"},na={class:"name"},la=["src"],oa={class:"percent"},ia={class:"loading-bar"},ra=u(()=>a("p",{style:{margin:"10px 0px 0px",color:"gray","font-size":"12px"}},"Atleast 3 pictures for a property is required",-1)),ca=u(()=>a("p",{style:{margin:"10px 0px 0px",color:"gray","font-size":"12px"}},"Hold CTRL to add multiple pictures at once on Laptops or Desktops",-1)),da=u(()=>a("p",{style:{margin:"10px 0px 0px",color:"gray","font-size":"12px"}},"Maximum of 30 pictures",-1)),ua=u(()=>a("p",{style:{margin:"10px 0px 0px",color:"gray","font-size":"12px"}},"Max 10MB per photo in .PNG, .JPG or .JPEG ",-1)),pa={class:"property"},fa=u(()=>a("h3",null,"Property Info",-1)),_a=u(()=>a("hr",{style:{margin:"0px"}},null,-1)),va=u(()=>a("b",null,"Property id",-1)),ma=u(()=>a("b",null,"Category",-1)),ha=u(()=>a("b",null,"Type",-1)),ga=u(()=>a("b",null,"Location",-1)),ya=u(()=>a("b",null,"Price",-1)),ba=["href"],wa={class:"remove buttons"},xa=["disabled"],ka=u(()=>a("span",{class:"publish_tooltip"},"Your property will be live and seen by potential customers.",-1)),Ea=u(()=>a("span",{class:"later_tooltip"},"Your property will be saved, but not be seen by potential customers until when published.",-1)),La={__name:"Post-Pictures",setup(B){const P=xe(),U=ke();i(!1),i(!1),i(void 0);let S=i(void 0),x=i(!1),k=i(!1),T=i(void 0),L=i(!1),M=i(void 0),A=i(!1),j=i(void 0),O=i(void 0),c=i(void 0),n=i([]),f=i([]),D=i(0),g=i([]),z=i([]);i([]);let N=i(!1),w=i(0),V=W([]),ae="https://easyrentage.s3.af-south-1.amazonaws.com/",R=W({}),q=i(void 0),te=i(void 0),C=i(!1);const{data:se,error:Ia}=Y("/api/loggedIn",I.loggedIn),{data:ne,error:Da}=Y("/api/fetch_properties",I.fetch_properties);setTimeout(()=>{let t=J(se.value);O.value=t.message,ge(O),R=t.user,V=J(ne.value);let l=Ee.get_pictures_page(P.params.id,O.value,R,V.listings);switch(l.message){case"Bad request":window.location.assign("/dashboard/manage-listings?page=1");break;case"error occured":window.location.assign("/error");break;default:c.value=l.message,n.value=l.message.pictures,w.value=30-n.value.length;break}},1e3),Le(()=>{F(),window.addEventListener("resize",F)}),Ie(()=>{window.removeEventListener("resize",F)});function le(t){let l=n.value.length;if(w.value=30-l,t.target.files.length>w.value)C.value=!0;else{if(C.value="",Array.from(t.target.files).forEach(e=>{G(e)&&f.value.push(e)}),f.value.length===0)return;for(let e=D.value;e<f.value.length;e++){let p=new FormData;const o=f.value[e].name.length>30?`${f.value[e].name.slice(0,30)}...`:f.value[e].name;p.append("file",f.value[e]),p.append("listing_id",P.params.id),g.value.push({index:e,name:o,loading:0,url:URL.createObjectURL(f.value[e])}),N.value=!0,z.value[e]=$.ajax({xhr:function(){var _=new window.XMLHttpRequest;return _.upload.addEventListener("progress",function(r){r.lengthComputable&&(g.value[e].loading=Math.floor(r.loaded/r.total*100),r.loaded===r.total&&n.value.push("distraction"))},!1),_},type:"POST",url:"/api/submit_pictures",data:p,processData:!1,contentType:!1,success:function(_){n.value=n.value.filter(r=>r!=="distraction"),_.message.forEach(r=>{n.value.includes(r)||n.value.push(r)})}})}D.value=g.value.length}}function oe(t){t.preventDefault();let l=n.value.length;if(w.value=30-l,t.dataTransfer.files.length>w.value)C.value=!0;else{if(C.value="",Array.from(t.dataTransfer.files).forEach(e=>{G(e)&&f.value.push(e)}),f.value.length===0)return;for(let e=D.value;e<f.value.length;e++){let p=new FormData;const o=f.value[e].name.length>30?`${f.value[e].name.slice(0,30)}...`:f.value[e].name;p.append("file",f.value[e]),p.append("listing_id",P.params.id),g.value.push({index:e,name:o,loading:0,url:URL.createObjectURL(f.value[e])}),N.value=!0,z.value[e]=$.ajax({xhr:function(){var _=new window.XMLHttpRequest;return _.upload.addEventListener("progress",function(r){r.lengthComputable&&(g.value[e].loading=Math.floor(r.loaded/r.total*100),r.loaded===r.total&&n.value.push("distraction"))},!1),_},type:"POST",url:"/api/submit_pictures",data:p,processData:!1,contentType:!1,success:function(_){n.value=n.value.filter(r=>r!=="distraction"),_.message.forEach(r=>{n.value.includes(r)||n.value.push(r)})}})}D.value=g.value.length}}function ie(t,l){z.value[t].abort(),g.value[l]={}}function G(t){let l=t.type.split("/")[0],e=t.size;return l!="image"||e>1e7?(q.value="Only images not larger than 10mb are allowed.",!1):(q.value="",te.value="",!0)}function re(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"}function ce(t){t.preventDefault()}function de(){g.value=[],f.value=[],z.value=[],D.value=0}async function ue(t){const l=t.target.nodeName;let e,p,o;switch(l){case"P":p=t,e=p.srcElement.parentElement.children[0].currentSrc.split("/"),o=e[e.length-1],p.srcElement.innerHTML="Removing...",await I.delete_pictures({data:{imgsrc:o,listing_id:c.value.id}}),p.srcElement.innerHTML='Delete <svg data-v-0a97cd18="" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="trash" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" id="cancel" class="svg-inline--fa fa-trash"><path data-v-0a97cd18="" fill="currentColor" d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z" class=""></path></svg>',n.value=n.value.filter(_=>_!==o),w.value=30-n.value.length;break;case"path":p=t,e=p.srcElement.parentElement.parentElement.parentElement.children,o=e[0].currentSrc.split("/")[e[0].currentSrc.split("/").length-1],e[1].innerHTML="Removing...",await I.delete_pictures({data:{imgsrc:o,listing_id:c.value.id}}),e[1].innerHTML='Delete <svg data-v-0a97cd18="" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="trash" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" id="cancel" class="svg-inline--fa fa-trash"><path data-v-0a97cd18="" fill="currentColor" d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z" class=""></path></svg>',n.value=n.value.filter(_=>_!==o),w.value=30-n.value.length;break}}function pe(){j.value="Are you sure you want to delete all pictures",A.value=!0}async function fe(t){const l=n.value;let e=0;for(;e<l.length;)await I.delete_pictures({data:{imgsrc:l[e],listing_id:c.value.id}}),e++;window.location.replace(`/dashboard/post-pictures/${c.value.id}`)}function _e(){A.value=!1}function F(){setTimeout(()=>{let t=document.getElementById("main_nav");X.screenhandler(window.innerWidth,1027,t)},1e3)}function ve(){let t=document.getElementById("main_nav"),l=document.getElementById("dashboard_nav");t.style.display==="none"?t.style.display="inline-block":t.style.display="none",l.style.display="none"}function me(){let t=document.getElementById("main_nav"),l=document.getElementById("dashboard_nav");l.style.display==="none"?l.style.display="inline-block":l.style.display="none",t.style.display="none"}async function he(t){let l=document.getElementById("dashboard_nav"),e=document.getElementById("main_nav"),p=document.getElementById("sub_div"),o=document.getElementById("insufficient_coin_nav"),_=document.getElementById("insufficient_coin_cover");t.target.className.toString().includes("remove")==!1&&(l.style.display="none",p.style.display="none",o.style.display="none",_.style.display="none"),X.removenav(t,window.innerWidth,1027,e)}function ge(t){t.value===!0?(S.value=!1,T.value=!0):(S.value=!0,T.value=!1,U.push({name:"home"}))}async function ye(){if(x.value=!0,k.value=!0,n.value.length<3){M.value="You need atleast 3 pictures in other to publish listing",L.value=!0,x.value=!1,k.value=!1;return}if(R.easycoins<1){let t=document.getElementById("insufficient_coin_nav"),l=document.getElementById("insufficient_coin_cover");l.style.display="block",t.style.display="block",k.value=!1,x.value=!1;return}else switch((await I.change_status({listing_id:c.value.id,status:"Pending"})).message){case"Success":x.value=!1,k.value=!1,U.push({name:"review",query:{listing_id:c.value.id}});break;case"Bad request":M.value="An error occured, please try again later.",L.value=!0,x.value=!1,k.value=!1;break;case"error occured":this.error_description="An error occured, please try again later.",L.style.display="block",this.spinner=!1,this.disablebtn=!1;break;default:M.value="An error occured, please try again later.",L.value=!0,x.value=!1,k.value=!1;break}}function be(t){L.value=!1}return(t,l)=>{const e=K("font-awesome-icon"),p=K("router-link");return d(),h("div",{id:"body",onClick:he},[Te,a("div",Ae,[a("h1",Oe,[y("Insufficient easycoin"),b(e,{class:"fa-solid fa-xmark",id:"xmark",icon:"fa-solid fa-xmark",style:{display:"inline-block",float:"right","font-size":"17px",cursor:"pointer"}})]),Ne,$e,qe]),a("div",Fe,[b(Ce,{id:"main_nav",style:{display:"none"}}),Ue,b(e,{class:"remove fa-solid fa-navicon",onClick:ve,id:"hamburger",icon:"fa-solid fa-navicon"}),b(De,{id:"dashboard_nav",easycoins:s(R).easycoins,style:{display:"none"}},null,8,["easycoins"]),a("ul",je,[s(S)?(d(),E(p,{key:0,to:"/sign-in",class:"",id:"signInbtn"},{default:Q(()=>[y("Sign in")]),_:1})):v("",!0),s(T)?(d(),h("li",{key:1,class:"remove",style:{padding:"0px"},onClick:me},"Menu")):v("",!0)])]),s(L)?(d(),E(Pe,{key:0,id:"display_error_modal",error_description:s(M),onRemove_error_modal:be},null,8,["error_description"])):v("",!0),s(A)?(d(),E(Se,{key:1,id:"display_confirmation_modal",category:s(j),onRemove_confirmation_modal:_e,onDelete_modal:fe},null,8,["category"])):v("",!0),a("div",Ve,[a("div",Ge,[a("h1",null,"Add Pictures ("+m(s(n).length)+")",1),a("div",We,[(d(!0),h(Z,null,ee(s(n),o=>(d(),h("div",{class:"photos",ref_for:!0,ref:"photos"},[o==="distraction"?(d(),E(e,{key:0,class:"fa-solid fa-spinner fa-spin",style:{"font-size":"50px",display:"inline-block","text-align":"center",padding:"40px 0px",color:"rgba(10,142,146,.884)"},icon:"fa-solid fa-spinner fa-spin"})):v("",!0),o==="distraction"?(d(),h("h1",Ye,"Loading image")):v("",!0),o!=="distraction"?(d(),h("img",{key:2,src:s(ae)+o},null,8,Je)):v("",!0),s(n).includes("distraction")===!1?(d(),h("p",{key:3,onClick:ue},[y("Delete "),b(e,{class:"fa-solid fa-trash",id:"cancel",icon:"fa-solid fa-trash"})])):v("",!0)],512))),256))]),s(n).length>2&&s(n).includes("distraction")===!1?(d(),h("h1",{key:0,id:"delete_all_btn",onClick:pe},[y("Delete all pictures "),b(e,{class:"fa-solid fa-trash",icon:"fa-solid fa-trash"})])):v("",!0),a("div",null,[a("label",{for:"myuploads",class:"dropzone__box",onDragover:H(re,["prevent"]),onDragleave:H(ce,["prevent"]),onDrop:H(oe,["prevent"])},[Xe,Ke,a("div",Qe,[a("p",Ze,m(s(q)),1),s(C)?(d(),h("p",ea,m(`Listing cannot have more than 30 pictures. ${s(w)} SPOT LEFT`),1)):v("",!0)]),a("input",{type:"file",id:"myuploads",onChange:le,name:"file",multiple:"",hidden:""},null,32)],32),s(N)?(d(),h("section",aa,[(d(!0),h(Z,null,ee(s(g),(o,_)=>(d(),h("div",null,[o.name?(d(),h("li",ta,[a("div",sa,[a("span",na,[a("img",{id:"img",src:o.url},null,8,la),y(" "+m(o.name),1)]),a("span",oa,[y(m(o.loading)+"% ",1),o.loading==100?(d(),E(e,{key:0,class:"fa-solid fa-check",icon:"fa-solid fa-check"})):v("",!0),o.loading!=100?(d(),E(e,{key:1,class:"fa-solid fa-xmark",icon:"fa-solid fa-xmark",onClick:r=>ie(o.index,_),style:{color:"red"}},null,8,["onClick"])):v("",!0)])]),a("div",ia,[a("div",{class:"loading",style:Be({width:o.loading+"%"})},null,4)])])):v("",!0)]))),256)),s(g).length>0?(d(),h("p",{key:0,onClick:de,style:{margin:"0","background-color":"#be7575",width:"50px","text-align":"center",cursor:"pointer",color:"white",padding:"3px","font-size":"15px"}},"Clear")):v("",!0)])):v("",!0),ra,ca,da,ua])]),a("div",pa,[fa,_a,a("h2",null,[b(e,{class:"fa-solid fa-house",icon:"fa-solid fa-house"}),y(" "+m(`${s(c).bedroom}`>0?`${s(c).bedroom} bedroom`:" ")+" "+m(`${s(c).subtype}`||`${s(c).type}`)+" "+m(`${s(c).category}`),1)]),va,a("p",null,m(s(c).id),1),ma,a("p",null,m(s(c).category),1),ha,a("p",null,m(s(c).type),1),ga,a("p",null,m(s(c).location)+" "+m(s(c).town)+", "+m(s(c).state)+" state.",1),ya,a("p",null,m(new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(s(c).price))+" "+m(s(c).payment),1),a("a",{href:"/dashboard/edit-listing/"+s(c).id,class:"sub_info_child"},"Edit Info",8,ba)]),a("div",wa,[a("button",{id:"publish_now",class:"remove",onClick:H(ye,["prevent"]),disabled:s(k)},[s(x)?(d(),E(e,{key:0,style:{color:"white"},class:"fa-solid fa-spinner fa-spin",id:"spinner",icon:"fa-solid fa-spinner"})):v("",!0),y(" Publish now "),ka],8,xa),b(p,{to:{name:"manageListings",query:{page:1},params:{message:"Listing saved succesfully"}},id:"later"},{default:Q(()=>[y("Later "),Ea]),_:1})])]),b(Me)])}}},za=we(La,[["__scopeId","data-v-37b05b55"]]);export{za as default};

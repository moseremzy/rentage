import{_ as _e,u as pe,a as ge,r as n,f as L,g as H,t as W,P as $,o as fe,h as he,H as G,i as M,b as i,c as _,e,j as r,k as c,l as R,m as u,D as ye,w as j,n as p,x as me,N as be,J as ve,B as we,C as ke,E as qe,z as l,s as Ee,A as h,M as Re,Q as Ie,K as Pe,F as Ae,p as De,d as Be,q as Ce}from"./index-LjW8QbZt.js";import{E as xe}from"./ErrorModal-_8tJkFS0.js";import{C as Se}from"./ConfirmationModal-qGjs4P3k.js";import{C as Ne}from"./auto-lleZGeOg.js";const d=I=>(De("data-v-f5c1ec6e"),I=I(),Be(),I),Ue={class:"header"},Le=d(()=>e("div",{class:"logo"},[e("a",{href:"#"},[e("img",{src:Ce,id:"logo",alt:"Logo"})])],-1)),Me={class:"accesslinks"},Te={class:"container"},Oe=d(()=>e("h1",null,"My Requests",-1)),ze={href:"/post-request",class:"",id:"add_property"},Ve={class:"filter_action_flex"},Fe={class:"filter"},He={for:"filter"},We=d(()=>e("option",null,"All",-1)),$e=d(()=>e("option",null,"Unpublished requests",-1)),Ge=d(()=>e("option",null,"Pending requests",-1)),je=d(()=>e("option",null,"Published requests",-1)),Je=[We,$e,Ge,je],Ke={class:"delete"},Qe={for:"delete"},Ye={id:"delete_nav",class:"select_delete",style:{display:"none"}},Ze={class:"details_container"},Xe={class:"flex_details"},es={class:"details"},ss=d(()=>e("h3",null,"Details",-1)),ts=d(()=>e("hr",{style:{margin:"0px"}},null,-1)),as=d(()=>e("b",null,"Request Id",-1)),os=d(()=>e("b",null,"Type",-1)),ns={key:0},ls={key:1},is={key:2},ds={key:3},rs={key:4},cs={key:5},us=d(()=>e("b",null,"Location",-1)),_s=d(()=>e("b",null,"Budget",-1)),ps=d(()=>e("b",null,"Requester",-1)),gs=d(()=>e("b",null,"Date",-1)),fs=d(()=>e("b",null,"Status",-1)),hs=d(()=>e("hr",{style:{"margin-bottom":"0px"}},null,-1)),ys={class:"sub_info"},ms=["onClick"],bs=d(()=>e("span",{class:"publish_tooltip"},"Your request will be shown to agents on easyrentage.",-1)),vs={key:0,id:"no_property"},ws={key:1,class:"pagination"},ks={style:{"font-size":"16px"}},qs=Ee('<div class="status_meaning" data-v-f5c1ec6e><ul data-v-f5c1ec6e><li style="color:green;" data-v-f5c1ec6e>Published - <b style="color:black;font-weight:lighter;" data-v-f5c1ec6e> Property request has been approved and will be seen by site visitors.</b></li><li style="color:gray;" data-v-f5c1ec6e>Pending - <b style="color:black;font-weight:lighter;" data-v-f5c1ec6e> Property request is been reviewed, and awaiting approval.</b></li><li style="color:red;" data-v-f5c1ec6e>Unpublished - <b style="color:black;font-weight:lighter;" data-v-f5c1ec6e> Property request was rejected or has not been submitted for review.</b></li></ul></div>',1),Es={"data-v-4d76e25b":"",class:"chart-list",style:{color:"rgb(124, 134, 142)","font-size":"15px"}},Rs=d(()=>e("canvas",{id:"myChart"},null,-1)),Is={style:{"font-weight":"bolder"}},Ps={__name:"Manage-Requests",setup(I){const y=pe(),J=ge();let T=n(!0);n(!1),n(!1);let B=n(void 0),C=n(void 0),O=n(void 0),x=n(!1),P=n(!1),S=n(void 0),m=n(void 0),A=n(void 0),b=n(void 0),v=L([]),w=L([]),k=L({}),g=n(void 0),z=n(void 0),q=n(void 0);n(void 0);const V=n(null),F=n(null);n(null);const{data:K,error:As}=H("/api/loggedIn",h.loggedIn),{data:Q,error:Ds}=H("/api/fetch_requests",h.fetch_requests);setTimeout(()=>{let t=W(K.value);A.value=t.message,oe(A),k=t.user,g.value=k.settings.filterRequests||"",w=W(Q.value);let a=$.get_managerequest_page(y.query.page,g.value,A.value,k,w.all_requests);switch(a.message){case"Bad request":window.location.assign("/page-not-found");break;case"error occured":window.location.assign("/error");break;case"user does not exist":window.location.assign("/");break;default:v=a.paginatedRequests,w=a.all_requests,q.value=a.total_pages,te();break}},1e3),fe(()=>{N(),window.addEventListener("resize",N),z.value=y.query.page,se(),ae(),T.value=!1}),he(()=>{window.removeEventListener("resize",N)});function N(){setTimeout(()=>{let t=document.getElementById("main_nav");G.screenhandler(window.innerWidth,1027,t)})}function Y(){let t=document.getElementById("main_nav"),a=document.getElementById("dashboard_nav"),o=document.getElementById("delete_nav");t.style.display==="none"?t.style.display="inline-block":t.style.display="none",a.style.display="none",o.style.display="none"}function Z(){let t=document.getElementById("main_nav"),a=document.getElementById("dashboard_nav"),o=document.getElementById("delete_nav");a.style.display==="none"?a.style.display="inline-block":a.style.display="none",t.style.display="none",o.style.display="none"}function X(){let t=document.getElementById("main_nav"),a=document.getElementById("dashboard_nav"),o=document.getElementById("delete_nav");o.style.display==="inline-block"?o.style.display="none":o.style.display="inline-block",t.style.display="none",a.style.display="none"}function ee(t){let a=document.getElementById("dashboard_nav"),o=document.getElementById("main_nav"),D=document.getElementById("sub_div"),U=document.getElementById("delete_nav");t.target.className.toString().includes("remove")==!1&&(a.style.display="none",U.style.display="none",D.style.display="none"),G.removenav(t,window.innerWidth,1027,o)}function se(){O.value=y.params.message,window.setTimeout(()=>{O.value=void 0},3e3)}function te(t){const a=document.getElementById("myChart");new Ne(a,{type:"bar",data:{labels:["Published Requests","Unpublished Requests","Pending Requests"],datasets:[{label:" Property Requests Statistics",maxBarThickness:88,minBarLength:1,data:[f("Published"),f("Unpublished"),f("Pending")]}]},options:{scales:{y:{beginAtZero:!0}}}})}function ae(){window.setInterval(()=>{},1e3)}function oe(t){t.value===!0?(B.value=!1,C.value=!0):(B.value=!0,C.value=!1,window.location.assign("/sign-in"))}function f(t){return w.filter(function(o){return o.status===t}).length}function E(t){switch(t.target.innerText){case" Delete All requests":m.value="All your requests will be deleted, do you wish to continue",b.value=void 0;break;case" Delete Unpublished requests":m.value="All unpublished requests will be deleted, do you wish to continue",b.value=void 0;break;case" Delete Pending requests":m.value="All pending requests will be deleted, do you wish to continue",b.value=void 0;break;case" Delete Published requests":m.value="All published requests will be deleted, do you wish to continue",b.value=void 0;break;case" Delete":m.value="Are you sure you want to delete property request with id ",b.value=`${t.target.parentElement.parentElement.children[3].innerHTML}`;break}P.value=!0}async function ne(t){var a;switch(t){case"All your requests will be deleted, do you wish to continue":a=await h.delete_requests_categorically({data:{category:"Delete All requests"}}),window.location.assign("/dashboard/manage-requests?page=1");break;case"All unpublished requests will be deleted, do you wish to continue":a=await h.delete_requests_categorically({data:{category:"Delete Unpublished requests"}}),a.message==="There was an error..."?(x.value=!0,S.value=a.message,P.value=!1):window.location.assign("/dashboard/manage-requests?page=1");break;case"All pending requests will be deleted, do you wish to continue":a=await h.delete_requests_categorically({data:{category:"Delete Pending requests"}}),window.location.assign("/dashboard/manage-requests?page=1");break;case"All published requests will be deleted, do you wish to continue":a=await h.delete_requests_categorically({data:{category:"Delete Published requests"}}),window.location.assign("/dashboard/manage-requests?page=1");break;default:let o=`${t.split(" ")[t.split(" ").length-1]}`;a=await h.delete_request({data:{request_id:o}}),window.location.assign("/dashboard/manage-requests?page=1");break}}function le(){P.value=!1}function ie(t){let a=document.getElementById("display_error_modal");a.value=!1}function de(){y.query.page!=q.value?(window.location.assign("/dashboard/manage-requests?page="+ ++this.$route.query.page),v=respnse.message):V.attributes[1].nodeValue="color: gray;"}function re(){y.query.page!=1?(window.location.assign("/dashboard/manage-requests?page="+--this.$route.query.page),v=respnse.message):F.attributes[1].nodeValue="color: gray;"}async function ce(){let t=$.get_managerequest_page(y.query.page,g.value,A.value,k,w.all_requests);v=t.paginatedListings,q=t.total_pages,z=y.query.page,window.location.assign("/dashboard/manage-requests?page=1"),await h.filter({parameter:g.value,page:"request"})}async function ue(t){const a=await h.submit_request(t);switch(a.message){case"success":J.push({name:"requestReview"});break;default:S.value=a.message,x.value=!0;break}}return(t,a)=>{const o=M("font-awesome-icon"),D=M("router-link"),U=M("LOADER");return i(),_("div",{id:"body",onClick:ee},[e("div",Ue,[r(Re,{id:"main_nav",style:{display:"none"}}),c(x)?(i(),R(xe,{key:0,id:"display_error_modal",error_description:c(S),onRemove_error_modal:ie},null,8,["error_description"])):u("",!0),Le,r(o,{class:"remove fa-solid fa-navicon",onClick:Y,id:"hamburger",icon:"fa-solid fa-navicon"}),r(ye,{id:"dashboard_nav",easycoins:c(k).easycoins,style:{display:"none"}},null,8,["easycoins"]),e("ul",Me,[c(B)?(i(),R(D,{key:0,to:"/sign-in",class:"",id:"signInbtn"},{default:j(()=>[p("Sign in")]),_:1})):u("",!0),c(C)?(i(),_("li",{key:1,class:"remove",style:{padding:"0px"},onClick:Z},"Menu")):u("",!0)])]),r(Ie),c(P)?(i(),R(Se,{key:0,id:"display_confirmation_modal",category:c(m),listing_id:c(b),onRemove_confirmation_modal:le,onDelete_modal:ne},null,8,["category","listing_id"])):u("",!0),e("div",Te,[Oe,e("a",ze,[p("Create Request "),r(o,{class:"fa-solid fa-circle-plus",icon:"fa-solid fa-circle-plus",style:{"font-size":"12px"}})]),e("div",Ve,[e("div",Fe,[e("label",He,[p("Show "),r(o,{class:"fa-solid fa-filter",icon:"fa-solid fa-filter",style:{"font-size":"12px"}})]),me(e("select",{id:"filter","onUpdate:modelValue":a[0]||(a[0]=s=>ve(g)?g.value=s:g=s),onChange:ce},Je,544),[[be,c(g)]])]),e("div",Ke,[e("label",Qe,[p("Action "),r(o,{class:"fa-solid fa-trash",icon:"fa-solid fa-trash",style:{"font-size":"12px"}})]),e("button",{id:"delete_btn",onClick:we(X,["prevent"]),class:"remove"},[p("Delete "),e("span",Ye,[e("p",{onClick:E},[r(o,{class:"fa-solid fa-trash",icon:"fa-solid fa-trash"}),p(" Delete All requests")]),e("p",{onClick:E},[r(o,{class:"fa-solid fa-trash",icon:"fa-solid fa-trash"}),p(" Delete Unpublished requests")]),e("p",{onClick:E},[r(o,{class:"fa-solid fa-trash",icon:"fa-solid fa-trash"}),p(" Delete Pending requests")]),e("p",{onClick:E},[r(o,{class:"fa-solid fa-trash",icon:"fa-solid fa-trash"}),p(" Delete Published requests ")])])])])]),c(T)?(i(),R(U,{key:0})):u("",!0),e("div",Ze,[e("div",Xe,[(i(!0),_(ke,null,qe(c(v),s=>(i(),_("div",es,[ss,ts,as,e("p",null,l(s.id),1),os,e("p",null,l(s.subtype||s.type)+" "+l(s.category),1),s.bedroom?(i(),_("b",ns,"Bedrooms")):u("",!0),s.bedroom?(i(),_("p",ls,l(s.bedroom),1)):u("",!0),s.classroom?(i(),_("b",is,"Classrooms")):u("",!0),s.classroom?(i(),_("p",ds,l(s.classroom),1)):u("",!0),s.fuelpump?(i(),_("b",rs,"Fuelpumps")):u("",!0),s.fuelpump?(i(),_("p",cs,l(s.fuelpump),1)):u("",!0),us,e("p",null,l(s.town)+", "+l(s.state)+" state",1),_s,e("p",null,l(new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(s.price)),1),ps,e("p",null,l(s.person_type),1),gs,e("p",null,l(s.dateAdded),1),fs,e("p",{style:Pe(s.status==="Published"?{color:"green"}:s.status==="Unpublished"?{color:"red"}:{color:"gray"})},l(s.status),5),hs,e("div",ys,[s.status==="Published"||s.status==="Unpublished"?(i(),R(D,{key:0,to:"/dashboard/edit-request/"+s.id,class:"sub_info_child"},{default:j(()=>[r(o,{class:"fa-solid fa-pen-to-square",icon:"fa-solid fa-pen-to-square"}),p(" Edit")]),_:2},1032,["to"])):u("",!0),s.status==="Unpublished"?(i(),_("p",{key:1,onClick:Bs=>ue({category:s.category,type:s.type,subtype:s.subtype,town:s.town,state:s.state,price:s.price,bedroom:s.bedroom,classroom:s.classroom,fuelpump:s.fuelpump,description:s.description,contact:s.contact,name:s.name,email:s.email,person_type:s.person_type,id:s.id}),class:"sub_info_child",id:"publish_now"},[r(o,{class:"fa-solid fa-upload",icon:"fa-solid fa-upload"}),p(" Publish "),bs],8,ms)):u("",!0),e("p",{class:"sub_info_child",onClick:E},[r(o,{class:"fa-solid fa-trash",icon:"fa-solid fa-trash"}),p(" Delete")])])]))),256))]),c(v).length===0?(i(),_("p",vs,"No "+l(c(g)==="All"?"property requests":c(g)),1)):u("",!0),c(q)>1?(i(),_("div",ws,[e("p",{style:{color:"black",cursor:"pointer"},ref_key:"previous_page",ref:F,onClick:re},[r(o,{class:"fa-solid fa-arrow-left-long",icon:"fa-solid fa-arrow-left-long"})],512),e("p",ks,"Page "+l(c(y).query.page)+" of "+l(c(q)),1),e("p",{style:{color:"black",cursor:"pointer"},ref_key:"next_page",ref:V,onClick:de},[r(o,{class:"fa-solid fa-arrow-right-long",icon:"fa-solid fa-arrow-right-long"})],512)])):u("",!0)]),qs,e("section",Es,[Rs,e("p",null,"Published Requests: "+l(f("Published")),1),e("p",null,"Unpublished Requests: "+l(f("Unpublished")),1),e("p",null,"Pending Requests: "+l(f("Pending")),1),e("p",Is,"Total Requests: "+l(f("Published")+f("Unpublished")+f("Pending")),1)])]),r(Ae)])}}},Us=_e(Ps,[["__scopeId","data-v-f5c1ec6e"]]);export{Us as default};
